# ğŸ©º è¡€é‡é¡¯ç¤ºç³»çµ± - ä½¿ç”¨èªªæ˜

## âœ¨ åŠŸèƒ½æ¦‚è¦½

æ–°å¢çš„è¡€é‡é¡¯ç¤ºç³»çµ±æä¾›å³æ™‚çš„è¦–è¦ºåŒ–è¡€é‡è³‡è¨Šï¼š

### ğŸ‘¤ ç©å®¶è¡€é‡é¡¯ç¤º
- **ä½ç½®ï¼š** ActionBarï¼ˆç”Ÿå‘½å€¼æ„›å¿ƒå’Œé£½è¶³æ„Ÿä¸Šæ–¹ï¼‰
- **æ›´æ–°é »ç‡ï¼š** æ¯ 0.5 ç§’ï¼ˆ10 ticksï¼‰
- **å³æ™‚æ›´æ–°ï¼š** å—å‚·æˆ–å›è¡€æ™‚ç«‹å³æ›´æ–°

### ğŸ‘¾ æ€ªç‰©è¡€é‡é¡¯ç¤º
- **ä½ç½®ï¼š** æ€ªç‰©åç¨±æ—é‚Š
- **æ›´æ–°é »ç‡ï¼š** æ¯ 1 ç§’ï¼ˆ20 ticksï¼‰
- **å³æ™‚æ›´æ–°ï¼š** å—å‚·æˆ–å›è¡€æ™‚ç«‹å³æ›´æ–°
- **åƒ…é™è‡ªå®šç¾©ç”Ÿç‰©ï¼š** åªæœ‰ä½¿ç”¨ `/custommob spawn` ç”Ÿæˆçš„ç”Ÿç‰©æ‰æœƒé¡¯ç¤ºè¡€é‡

---

## ğŸ¨ é¡¯ç¤ºæ•ˆæœ

### ç©å®¶è¡€é‡ (ActionBar)

```
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â¤ 20.0/20.0
```

é¡è‰²æœƒæ ¹æ“šè¡€é‡ç™¾åˆ†æ¯”è®ŠåŒ–ï¼š
- **ç¶ è‰²** `â–ˆ` - è¡€é‡ > 75%
- **é»ƒè‰²** `â–ˆ` - è¡€é‡ > 50%
- **æ©™è‰²** `â–ˆ` - è¡€é‡ > 25%
- **ç´…è‰²** `â–ˆ` - è¡€é‡ â‰¤ 25%

ç©ºè¡€éƒ¨åˆ†é¡¯ç¤ºç‚ºç°è‰² `â–`

### æ€ªç‰©è¡€é‡ï¼ˆåç¨±ï¼‰

```
[Lv.5] Â§7èè‹±æ®­å± â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 45/65
```

çµ„æˆï¼š
1. ç­‰ç´šæ¨™ç±¤ï¼š`[Lv.5]`ï¼ˆå¦‚æœå•Ÿç”¨ï¼‰
2. æ€ªç‰©åç¨±ï¼š`Â§7èè‹±æ®­å±`
3. è¡€é‡æ¢ï¼š`â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ`ï¼ˆ10 æ ¼ï¼‰
4. æ•¸å€¼ï¼š`45/65`ï¼ˆç•¶å‰/æœ€å¤§ï¼‰

---

## ğŸ”§ æŠ€è¡“ç´°ç¯€

### æ›´æ–°æ©Ÿåˆ¶

#### å®šæ™‚æ›´æ–°
- **ç©å®¶ï¼š** æ¯ 0.5 ç§’æƒææ‰€æœ‰åœ¨ç·šç©å®¶ä¸¦æ›´æ–°
- **æ€ªç‰©ï¼š** æ¯ 1 ç§’æƒææ‰€æœ‰ä¸–ç•Œçš„ç”Ÿç‰©ä¸¦æ›´æ–°

#### å³æ™‚æ›´æ–°ï¼ˆäº‹ä»¶è§¸ç™¼ï¼‰
- `EntityDamageEvent` - å¯¦é«”å—å‚·æ™‚
- `EntityRegainHealthEvent` - å¯¦é«”å›è¡€æ™‚
- `PlayerJoinEvent` - ç©å®¶åŠ å…¥ä¼ºæœå™¨æ™‚

### è¡€é‡æ¢è¨ˆç®—

```java
// è¡€é‡ç™¾åˆ†æ¯”
double percentage = current / max;

// è¨ˆç®—å¡«å……æ ¼æ•¸ï¼ˆ20 æ ¼ç©å®¶ï¼Œ10 æ ¼æ€ªç‰©ï¼‰
int filledBars = (int) Math.round(percentage * length);

// é¡è‰²é¸æ“‡
if (percentage > 0.75) -> ç¶ è‰² Â§a
else if (percentage > 0.5) -> é»ƒè‰² Â§e
else if (percentage > 0.25) -> æ©™è‰² Â§6
else -> ç´…è‰² Â§c
```

---

## ğŸ“‹ æ–°å¢çš„æ–‡ä»¶

### 1. HealthDisplayManager.java
**è·¯å¾‘ï¼š** `src/main/java/com/customrpg/managers/HealthDisplayManager.java`

**åŠŸèƒ½ï¼š**
- ç®¡ç†è¡€é‡é¡¯ç¤ºä»»å‹™
- ç”Ÿæˆè¡€é‡æ¢
- æ›´æ–°ç©å®¶å’Œæ€ªç‰©çš„è¡€é‡é¡¯ç¤º

**ä¸»è¦æ–¹æ³•ï¼š**
```java
// å•Ÿå‹•å®šæ™‚ä»»å‹™
private void startHealthDisplayTasks()

// æ›´æ–°ç©å®¶è¡€é‡ï¼ˆActionBarï¼‰
private void updatePlayerHealthDisplay(Player player)

// æ›´æ–°æ€ªç‰©è¡€é‡ï¼ˆåç¨±ï¼‰
private void updateMobHealthDisplay(LivingEntity mob)

// ç”Ÿæˆè¡€é‡æ¢
private String generateHealthBar(double current, double max, int length, char fullChar, char emptyChar)

// ç«‹å³æ›´æ–°ï¼ˆä¾›äº‹ä»¶ä½¿ç”¨ï¼‰
public void updatePlayerHealthImmediately(Player player)
public void updateMobHealthImmediately(LivingEntity mob)

// é—œé–‰æ‰€æœ‰ä»»å‹™
public void shutdown()
```

### 2. HealthDisplayListener.java
**è·¯å¾‘ï¼š** `src/main/java/com/customrpg/listeners/HealthDisplayListener.java`

**åŠŸèƒ½ï¼š**
- ç›£è½è¡€é‡è®ŠåŒ–äº‹ä»¶
- è§¸ç™¼å³æ™‚è¡€é‡æ›´æ–°

**ç›£è½äº‹ä»¶ï¼š**
- `PlayerJoinEvent` - ç©å®¶åŠ å…¥æ™‚é¡¯ç¤ºè¡€é‡
- `EntityDamageEvent` - å¯¦é«”å—å‚·æ™‚æ›´æ–°è¡€é‡
- `EntityRegainHealthEvent` - å¯¦é«”å›è¡€æ™‚æ›´æ–°è¡€é‡

---

## ğŸ® ä½¿ç”¨ç¯„ä¾‹

### ç©å®¶è¡€é‡é¡¯ç¤º

```
æ­£å¸¸ç‹€æ…‹ï¼ˆ100% è¡€é‡ï¼‰ï¼š
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â¤ 20.0/20.0

å—å‚·å¾Œï¼ˆ50% è¡€é‡ï¼‰ï¼š
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–â–â–â–â–â–â–â–â–â– â¤ 10.0/20.0

ç€•æ­»ï¼ˆ10% è¡€é‡ï¼‰ï¼š
â–ˆâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â– â¤ 2.0/20.0
```

### æ€ªç‰©è¡€é‡é¡¯ç¤º

```
æ»¿è¡€ï¼š
[Lv.5] Â§7èè‹±æ®­å± â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 65/65

å—å‚·ï¼š
[Lv.5] Â§7èè‹±æ®­å± â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–â–â–â– 40/65

ç€•æ­»ï¼š
[Lv.5] Â§7èè‹±æ®­å± â–ˆâ–ˆâ–â–â–â–â–â–â–â– 10/65
```

---

## âš™ï¸ é…ç½®é¸é …ï¼ˆæœªä¾†å¯æ“´å±•ï¼‰

ç›®å‰è¡€é‡é¡¯ç¤ºæ˜¯è‡ªå‹•å•Ÿç”¨çš„ï¼Œæœªä¾†å¯ä»¥æ·»åŠ é…ç½®é¸é …ï¼š

```yaml
# config/config.yml (å»ºè­°)
health-display:
  player:
    enabled: true
    update-interval: 10    # ticks (0.5 ç§’)
    bar-length: 20
    show-numbers: true
  
  mob:
    enabled: true
    update-interval: 20    # ticks (1 ç§’)
    bar-length: 10
    show-numbers: true
    only-custom-mobs: true  # åªé¡¯ç¤ºè‡ªå®šç¾©ç”Ÿç‰©
```

---

## ğŸ” é™¤éŒ¯è³‡è¨Š

### æª¢æŸ¥æ˜¯å¦æ­£å¸¸é‹ä½œ

1. **ç©å®¶è¡€é‡é¡¯ç¤º**
   - åŠ å…¥ä¼ºæœå™¨å¾Œï¼ŒActionBar æ‡‰ç«‹å³é¡¯ç¤ºè¡€é‡
   - å—å‚·æ™‚æ‡‰ç«‹å³æ›´æ–°

2. **æ€ªç‰©è¡€é‡é¡¯ç¤º**
   - ç”Ÿæˆè‡ªå®šç¾©ç”Ÿç‰©ï¼š`/custommob spawn test_zombie`
   - æŸ¥çœ‹æ€ªç‰©åç¨±ï¼Œæ‡‰åŒ…å«è¡€é‡æ¢
   - æ”»æ“Šæ€ªç‰©ï¼Œè¡€é‡æ¢æ‡‰ç«‹å³æ›´æ–°

### å¸¸è¦‹å•é¡Œ

**Q: ç©å®¶è¡€é‡æ²’æœ‰é¡¯ç¤ºï¼Ÿ**
- ç¢ºèªæ’ä»¶å·²æ­£ç¢ºè¼‰å…¥
- æª¢æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰ `HealthDisplayManager initialized` è¨Šæ¯
- å˜—è©¦é‡æ–°ç™»å…¥ä¼ºæœå™¨

**Q: æ€ªç‰©è¡€é‡æ²’æœ‰é¡¯ç¤ºï¼Ÿ**
- ç¢ºèªæ˜¯ä½¿ç”¨ `/custommob spawn` ç”Ÿæˆçš„è‡ªå®šç¾©ç”Ÿç‰©
- æ™®é€šåŸç‰ˆç”Ÿç‰©ä¸æœƒé¡¯ç¤ºè¡€é‡
- æª¢æŸ¥æ€ªç‰©æ˜¯å¦æœ‰è‡ªå®šç¾©åç¨±

**Q: è¡€é‡æ›´æ–°å»¶é²ï¼Ÿ**
- å®šæ™‚æ›´æ–°çš„å»¶é²æ˜¯æ­£å¸¸çš„ï¼ˆ0.5-1 ç§’ï¼‰
- å—å‚·æ™‚æ‡‰ç«‹å³æ›´æ–°ï¼ˆ1 tick å»¶é²ï¼‰
- å¦‚æœå»¶é²éå¤§ï¼Œæª¢æŸ¥ä¼ºæœå™¨æ•ˆèƒ½

---

## ğŸš€ æ•ˆèƒ½å„ªåŒ–

### ç›®å‰çš„å„ªåŒ–æªæ–½

1. **åˆ†é›¢æ›´æ–°é »ç‡**
   - ç©å®¶ï¼š10 ticksï¼ˆè¼ƒå¿«ï¼Œå› ç‚ºç©å®¶è¼ƒå°‘ï¼‰
   - æ€ªç‰©ï¼š20 ticksï¼ˆè¼ƒæ…¢ï¼Œå› ç‚ºæ€ªç‰©å¯èƒ½å¾ˆå¤šï¼‰

2. **äº‹ä»¶å³æ™‚æ›´æ–°**
   - åªåœ¨è¡€é‡å¯¦éš›è®ŠåŒ–æ™‚æ›´æ–°
   - å»¶é² 1 tick ç¢ºä¿è¡€é‡å·²æ”¹è®Š

3. **åªé¡¯ç¤ºè‡ªå®šç¾©ç”Ÿç‰©**
   - æ¸›å°‘éœ€è¦è™•ç†çš„å¯¦é«”æ•¸é‡
   - é¿å…æƒæå¤§é‡åŸç‰ˆç”Ÿç‰©

### å¦‚æœä¼ºæœå™¨å¡é “

å¯ä»¥èª¿æ•´æ›´æ–°é »ç‡ï¼š

**ç©å®¶æ›´æ–°é–“éš”ï¼š** ç¬¬ 47 è¡Œ
```java
playerHealthTask.runTaskTimer(plugin, 0L, 10L);  // æ”¹ç‚º 20L (1ç§’)
```

**æ€ªç‰©æ›´æ–°é–“éš”ï¼š** ç¬¬ 60 è¡Œ
```java
mobHealthTask.runTaskTimer(plugin, 0L, 20L);  // æ”¹ç‚º 40L (2ç§’)
```

---

## ğŸ“Š ç·¨è­¯ç‹€æ…‹

âœ… **BUILD SUCCESS**
- ç·¨è­¯æ™‚é–“ï¼š3.255 ç§’
- æ–°å¢æ–‡ä»¶ï¼š2 å€‹
- ä¿®æ”¹æ–‡ä»¶ï¼š1 å€‹
- JAR ä½ç½®ï¼š`target/CustomRPG-1.0.jar`

---

## ğŸ¯ æ¸¬è©¦æ¸…å–®

- [ ] ç©å®¶åŠ å…¥ä¼ºæœå™¨æ™‚é¡¯ç¤ºè¡€é‡
- [ ] ç©å®¶å—å‚·æ™‚è¡€é‡ç«‹å³æ›´æ–°
- [ ] ç©å®¶å›è¡€æ™‚è¡€é‡ç«‹å³æ›´æ–°
- [ ] è¡€é‡æ¢é¡è‰²éš¨ç™¾åˆ†æ¯”è®ŠåŒ–
- [ ] ç”Ÿæˆè‡ªå®šç¾©ç”Ÿç‰©å¾Œé¡¯ç¤ºè¡€é‡
- [ ] æ”»æ“Šæ€ªç‰©æ™‚è¡€é‡ç«‹å³æ›´æ–°
- [ ] æ€ªç‰©å›è¡€æ™‚è¡€é‡ç«‹å³æ›´æ–°
- [ ] æ€ªç‰©åç¨±åŒ…å«ç­‰ç´šå’Œè¡€é‡
- [ ] æ™®é€šåŸç‰ˆç”Ÿç‰©ä¸é¡¯ç¤ºè¡€é‡
- [ ] æ’ä»¶é—œé–‰æ™‚ä»»å‹™æ­£ç¢ºåœæ­¢

---

## ğŸ”® æœªä¾†æ“´å±•å»ºè­°

1. **å¯é…ç½®åŒ–**
   - å…è¨±åœ¨ config.yml ä¸­å•Ÿç”¨/ç¦ç”¨
   - è‡ªå®šç¾©è¡€é‡æ¢æ¨£å¼å’Œé•·åº¦

2. **Boss Bar æ”¯æ´**
   - ç‚º BOSS ç´šç”Ÿç‰©ä½¿ç”¨ BossBar é¡¯ç¤ºè¡€é‡
   - æ›´é†’ç›®çš„è¦–è¦ºæ•ˆæœ

3. **å‚·å®³æ•¸å­—**
   - é¡¯ç¤ºæµ®å‹•çš„å‚·å®³æ•¸å­—
   - ä½¿ç”¨ Hologram æˆ–ç²’å­æ•ˆæœ

4. **å›è¡€å‹•ç•«**
   - å›è¡€æ™‚é¡¯ç¤ºç¶ è‰²ç²’å­
   - è¡€é‡æ¢é–ƒçˆæ•ˆæœ

5. **åŸç‰ˆç”Ÿç‰©æ”¯æ´**
   - æ·»åŠ é¸é …ä»¥é¡¯ç¤ºæ‰€æœ‰ç”Ÿç‰©çš„è¡€é‡
   - å¯èƒ½å½±éŸ¿æ•ˆèƒ½ï¼Œéœ€è¬¹æ…

---

**å¯¦ç¾æ—¥æœŸï¼š** 2026-02-13  
**ç‰ˆæœ¬ï¼š** Health Display System v1.0  
**ç‹€æ…‹ï¼š** âœ… å®Œæˆä¸¦ç·¨è­¯æˆåŠŸ

äº«å—æ–°çš„è¡€é‡é¡¯ç¤ºç³»çµ±ï¼ğŸ©º

